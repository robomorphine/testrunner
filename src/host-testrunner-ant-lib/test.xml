<?xml version="1.0" encoding="UTF-8"?>
<project name="tester" default="default">
    
	<property file="../../local.properties" />
	<fail unless="sdk.dir" message="Property sdk.dir is not specified." />
	
	<path id="testmanager.classpath">
        <fileset dir="${sdk.dir}/tools/lib" includes="*.jar" />
		<pathelement path="bin" />
		<pathelement path="../host-testrunner-lib/bin" />
    </path>
	
    <classloader name="testmanager.loader" classpathref="testmanager.classpath" />
	
	<taskdef name="rbm-setup" loaderref="testmanager.loader"
	         classname="com.robomorphine.test.ant.SetupTask"
	         classpathref="testmanager.classpath" />
	
	<taskdef name="rbm-avd-config" loaderref="testmanager.loader"
	                 classname="com.robomorphine.test.ant.avd.AvdConfigTask"
	                 classpathref="testmanager.classpath" />
	
	<taskdef name="rbm-create-avd" loaderref="testmanager.loader"
	             classname="com.robomorphine.test.ant.CreateAvdTask"
	             classpathref="testmanager.classpath" />
	

    <taskdef name="rbm-delete-avd" loaderref="testmanager.loader"
                 classname="com.robomorphine.test.ant.DeleteAvdTask"
                 classpathref="testmanager.classpath" />
	
	<taskdef name="rbm-start-emulator" loaderref="testmanager.loader"
	                 classname="com.robomorphine.test.ant.StartEmulatorTask"
	                 classpathref="testmanager.classpath" />
	
	<taskdef name="rbm-stop-emulator" loaderref="testmanager.loader"
	                     classname="com.robomorphine.test.ant.StopEmulatorTask"
	                     classpathref="testmanager.classpath" />
	
	<taskdef name="rbm-stop-all-emulators" loaderref="testmanager.loader"
	                      classname="com.robomorphine.test.ant.StopEmulatorsTask"
	                      classpathref="testmanager.classpath" />
	
	<target name="default">
		<rbm-setup sdkdir="${sdk.dir}" />
	    <rbm-avd-config id="avd15" target="Google Inc.:Google APIs:15">
            <abi type="armeabi-v7a" />
            <snapshot enable="true" />
            <sdcard size="10" />            
	        <screen resolution="QVGA" density="hdpi" />
            <hardware>
                <ram size="1024" />
                <heap size="32" />
                <arg key="a" value="c" />
            </hardware>
	    </rbm-avd-config>
    	<rbm-create-avd name="test-avd-name" target="Google Inc.:Google APIs:15" force="true">
    		<abi type="armeabi-v7a" />
    		<snapshot enable="true" />
    		<sdcard size="10" />    		
    		<screen resolution="xlarge" density="hdpi" />
    		<hardware>
    			<ram size="1024" />
    			<heap size="64" />
    			<arg key="a" value="b" />
    		</hardware>
    	</rbm-create-avd>
				
		<rbm-create-avd name="test-avd15" avdconfig="avd15" force="true"/>
		
		<rbm-stop-all-emulators />
		<rbm-start-emulator avd="test-avd15" serialProperty="emulator-serial" >
			<arg value="-no-audio" />
		</rbm-start-emulator>
		<rbm-stop-emulator serial="${emulator-serial}" />
		<rbm-delete-avd name="test-avd15" />
    </target>
</project>
