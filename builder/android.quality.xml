<?xml version="1.0" encoding="UTF-8"?>
<project name="android.quality" >	
	<fail unless="builder.imported" 
	          message="Import build.xml in order to use ${ant.file.build.android.app} build file." />
		
	<target name="-quality-dirs" >
		<property name="quality.dir" location="${drop.dir}/${build.mode}/quality-reports" />
		<mkdir dir="${quality.dir}" />
	</target>
	
	<target name="-pmd-defaults" >
		<property name="project.pmd" value="true" />
	</target>
	
	<target name="pmd" depends="-quality-dirs, -pmd-defaults" if="${project.pmd}" >
		<property name="pmd.out.dir" location="${quality.dir}/pmd" />
		<mkdir dir="${pmd.out.dir}" />
		
        <pmd targetjdk="1.6" rulesetfiles="${builder.dir}/quality/pmd.xml" minimumPriority="4" >
           <formatter type="xml" toFile="${pmd.out.dir}/${project.name}.xml" />
           <fileset dir="${project.dir}/src">
              <include name="**/*.java"/>
           </fileset>
       </pmd>
	</target>
	
	<target name="-cpd-defaults" >
        <property name="project.cpd" value="true" />
    </target>
	
	<target name="cpd" depends="-quality-dirs, -cpd-defaults" if="${project.cpd}" >
        <property name="cpd.out.dir" location="${quality.dir}/cpd" />
        <mkdir dir="${cpd.out.dir}" />
		
	    <cpd minimumTokenCount="75" outputFile="${cpd.out.dir}/${project.name}.xml" format="xml" >
	    	<fileset dir="${project.dir}/src">
                <include name="**/*.java"/>
            </fileset>
	    </cpd>
    </target>

</project>
